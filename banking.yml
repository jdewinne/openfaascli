version: 1.0
provider:
  name: openfaas
functions:
  banking-cause-problem:
    lang: dockerfile
    image: jdewinne/stscli:4.0.1-22
    environment:
      fprocess: /usr/bin/run.sh cause_problem.sh
      write_timeout: 60s
      read_timeout: 60s
      exec_timeout: 60s
    environment_file:
      - ./stscli/cli-default.yml
      - ${CLI_OVERRIDE:-./stscli/cli-default.yml}
      - ./stscli/dl-default.yml
      - ${DL_OVERRIDE:-./stscli/dl-default.yml}
    secrets:
      - ${STS_PASSWORD:-sts-password}
      - ${ARTIFACTORY_PASSWORD:-artifactory-password}
  banking-fix-problem:
    lang: dockerfile
    image: jdewinne/stscli:4.0.1-22
    environment:
      fprocess: /usr/bin/run.sh fix_problem.sh
      write_timeout: 60s
      read_timeout: 60s
      exec_timeout: 60s
    environment_file:
      - ./stscli/cli-default.yml
      - ${CLI_OVERRIDE:-./stscli/cli-default.yml}
      - ./stscli/dl-default.yml
      - ${DL_OVERRIDE:-./stscli/dl-default.yml}
    secrets:
      - ${STS_PASSWORD:-sts-password}
      - ${ARTIFACTORY_PASSWORD:-artifactory-password}
  banking-load-topology:
    lang: dockerfile
    image: jdewinne/stscli:4.0.1-22
    environment:
      fprocess: /usr/bin/run.sh load_topology_banking.sh
      write_timeout: 300s
      read_timeout: 300s
      exec_timeout: 300s
    environment_file:
      - ./stscli/cli-default.yml
      - ${CLI_OVERRIDE:-./stscli/cli-default.yml}
      - ./stscli/dl-default.yml
      - ${DL_OVERRIDE:-./stscli/dl-default.yml}
    secrets:
      - ${STS_PASSWORD:-sts-password}
      - ${ARTIFACTORY_PASSWORD:-artifactory-password}    
  banking-send-metrics:
    lang: dockerfile
    image: jdewinne/stscli:4.0.1-22
    environment:
      fprocess: /usr/bin/run.sh send_metrics.sh
      write_timeout: 300s
      read_timeout: 300s
      exec_timeout: 300s
    environment_file:
      - ./stscli/cli-default.yml
      - ${CLI_OVERRIDE:-./stscli/cli-default.yml}
      - ./stscli/dl-default.yml
      - ${DL_OVERRIDE:-./stscli/dl-default.yml}
    secrets:
      - ${STS_PASSWORD:-sts-password}
      - ${ARTIFACTORY_PASSWORD:-artifactory-password}